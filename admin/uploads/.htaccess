# eFIND Uploads Directory - Security Configuration
# Prevent script execution in uploads directory

# Disable PHP execution
<FilesMatch "\.(php|php3|php4|php5|phtml|pl|py|jsp|asp|sh|cgi)$">
    Require all denied
</FilesMatch>

# Disable script execution
<IfModule mod_php7.c>
    php_flag engine off
</IfModule>

# Allow only specific file types
<FilesMatch "\.(jpg|jpeg|png|gif|bmp|pdf|doc|docx|xls|xlsx)$">
    Require all granted
</FilesMatch>

# Prevent directory listing
Options -Indexes

# Deny access to hidden files
<FilesMatch "^\.">
    Require all denied
</FilesMatch>

# Set proper MIME types
<IfModule mod_mime.c>
    AddType image/jpeg .jpg .jpeg
    AddType image/png .png
    AddType image/gif .gif
    AddType application/pdf .pdf
</IfModule>

# Disable server signature
ServerSignature Off

# Additional security headers
<IfModule mod_headers.c>
    Header set X-Content-Type-Options "nosniff"
    Header set X-Frame-Options "DENY"
</IfModule>
